<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Visualize Results</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">assignPOP</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="start.html">Get Started</a>
</li>
<li>
  <a href="analyze.html">Analyze Data</a>
</li>
<li>
  <a href="visualize.html">Visualize Results</a>
</li>
<li>
  <a href="examples.html">Examples</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alexkychen/assignPOP">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Visualize Results</h1>

</div>


<p>In this page, we demonstrate how to visualize assignment accuracy and membership probability results using box plots and stacked bar plots.</p>
<hr />
<div id="create-a-box-plot-for-assignment-accuracy" class="section level2">
<h2>Create a box plot for assignment accuracy</h2>
<p>After the assignment accuracy of Monte-Carlo cross-validation results is calculated (using <code>accuracy.MC</code>), we can use the following function to create a box plot to visualize the assignment accuracy.</p>
<pre class="r"><code># accuMC is the object (a data frame) returned from the function accuracy.MC()
accuracy.plot(accuMC, pop = &quot;all&quot;)</code></pre>
<div class="figure" style="text-align: center">
<img src="visualize_files/figure-html/run%20accuracy.plot-1.png" alt="Figure 1. Assignment accuracies estimated via Monte-Carlo cross-validation, with three levels of training individuals (50%, 70% and 90% of individuals from each population, on x-axis) crossed by four levels of training loci (top 10%, 25% and 50% highest Fst loci and all loci in color-coded boxes) by 30 resampling events." width="960" />
<p class="caption">
Figure 1. Assignment accuracies estimated via Monte-Carlo cross-validation, with three levels of training individuals (50%, 70% and 90% of individuals from each population, on x-axis) crossed by four levels of training loci (top 10%, 25% and 50% highest Fst loci and all loci in color-coded boxes) by 30 resampling events.
</p>
</div>
<p>The argument <code>pop</code> is used to specify which populations to be included in the plot. Multiple populations can be specified (e.g., <code>pop=c(&quot;pop_A,&quot;pop_B&quot;,&quot;pop_C&quot;)</code>) to create a faceted plot. If <code>pop</code> is not specified, assignment accuracy of overall populations (<code>pop=&quot;all&quot;</code>) will be used by default.</p>
<p>The function <code>accuracy.plot()</code> is built based on the <a href="https://cran.r-project.org/web/packages/ggplot2/ggplot2.pdf">ggplot2</a> library, so the plot can be modified using <a href="http://docs.ggplot2.org/current/">ggplot2</a>. Below we made another plot that includes the assignment accuracy results of overall and individual populations. We also adjusted its <em>y</em>-axis limits (<code>ylim</code>), drew a horizontal line (<code>annotate</code>), added a plot title (<code>ggtitle</code>).</p>
<pre class="r"><code>library(ggplot2)
accuracy.plot(accuMC, pop=c(&quot;all&quot;, &quot;pop_A&quot;, &quot;pop_B&quot;, &quot;pop_C&quot;)) +
  ylim(0, 1) + #Set y limit between 0 and 1
  annotate(&quot;segment&quot;,x=0.4,xend=3.6,y=0.33,yend=0.33,colour=&quot;red&quot;,size=1) + #Add a red horizontal line at y = 0.33 (null assignment rate for 3 populations)
  ggtitle(&quot;Monte-Carlo cross-validation using genetic loci&quot;)+ #Add a plot title
  theme(plot.title = element_text(size=20, face=&quot;bold&quot;)) #Edit plot title text size</code></pre>
<div class="figure" style="text-align: center">
<img src="visualize_files/figure-html/modify%20AA%20plot-1.png" alt="Figure 2. Assignment accuracies estimated via Monte-Carlo cross-validation, with genetic data (693 SNP loci) for three hypothetical populations of 30 individuals. Red horizontal lines indicate 0.33 null assignment rate." width="960" />
<p class="caption">
Figure 2. Assignment accuracies estimated via Monte-Carlo cross-validation, with genetic data (693 SNP loci) for three hypothetical populations of 30 individuals. Red horizontal lines indicate 0.33 null assignment rate.
</p>
</div>
<p>The above results were estimated from the genetic data (simulated 1000 SNPs). Assignment accuracies of populations A and B are relatively low whereas those of population C are high, indicating that the genetic data could be used to distinguish between population C and population A or B.</p>
<p>Next, we created the assignment accuracy plot for the integrated data (genetics plus morphometrics, the object <code>comin</code> returned from <code>compile.data</code>). We skip the codes and show the results below.</p>
<div class="figure" style="text-align: center">
<img src="visualize_files/figure-html/create%20faceted%20plots%20for%20integrated%20data-1.png" alt="Figure 3. Assignment accuracies estimated via Monte-Carlo cross-validation, using genetic and morphometric data. Each box is the results of using a proportion of training loci plus 4 morphometric variables" width="960" />
<p class="caption">
Figure 3. Assignment accuracies estimated via Monte-Carlo cross-validation, using genetic and morphometric data. Each box is the results of using a proportion of training loci plus 4 morphometric variables
</p>
</div>
<p>When using the genetic-morphometric data, the assignment accuracies of populations A and B increased and that of population C remained high, resulting in increasing overall assignment accuracy. These results demonstrate the potential of using multiple data types to improve assignment success. Additionally, we can use the same analytical methods (i.e., Monte-Carlo cross-validation with the same proportions of training individuals, iterations, and classifier) to evaluate the discriminatory power of morphometric data.</p>
<div class="figure" style="text-align: center">
<img src="visualize_files/figure-html/unnamed-chunk-2-1.png" alt="Figure 4. Assignment accuracies estimated via Monte-Carlo cross-validation, using four morphometric measurements." width="960" />
<p class="caption">
Figure 4. Assignment accuracies estimated via Monte-Carlo cross-validation, using four morphometric measurements.
</p>
</div>
<p>The above results indicate that morphometric data helps distinguish population A from the other two. Therefore, it is expected that using integrated data would best discriminate among the three populations (Figure 3) despite that fact that using genetics or morphometrics alone was unable to distinguish population B from the other two (see population B in Figure 2 and 4).</p>
<hr />
</div>
<div id="create-a-membership-probability-plot" class="section level2">
<h2>Create a membership probability plot</h2>
<p>In addition to estimating assignment accuracy, we can use probabilities to understand how individuals are assigned to the populations. To visualize membership probability, we use the results from <em>K</em>-fold cross-validation and create a stacked bar plot, like the <a href="http://pritchardlab.stanford.edu/structure.html"><strong>STRUCTURE plot</strong></a>) that is commonly used in molecular biology papers.</p>
<pre class="r"><code># The folder &#39;Result-folder2&#39; contains the results generated from K-fold cross-validation
membership.plot(dir = &quot;Result-folder2/&quot;)</code></pre>
<p>After entering the above function, it will prompt a few questions and allow you to choose which data set (results estimated from which combination of training data) and plot style to be used. The interactive conversation is shown as follows.</p>
<p>The first question is to choose the results from which fold.</p>
<pre><code>## K = 3  4  5  are found.
## Please enter one of the K numbers: (You will enter your answer here)</code></pre>
<p>The second question is to choose the results from which level of training loci (if data include genetic loci).</p>
<pre><code>## 4 levels of training loci are found.
## Levels[train.loci]: 0.1  0.25  0.5  1
## Please enter one of the levels: (You will enter your answer here)</code></pre>
<p>Lastly, if you didn’t specify the output style (e.g., <code>style = 1</code>) in <code>membership.plot()</code>, then it will print the following message and ask you to choose an output style.</p>
<pre><code>## Finally, select one of the output styles.
## [1] Random order (Individuals on x-axis are in random order)
## [2] Sorted by probability (Individuals are sorted by probabilities within each group)
## [3] Separated by fold (Individuals of different folds are in separate plots)
## [4] Separated and Sorted (Individuals are separated by fold and sorted by probability)
## Please enter 1, 2, 3, or 4: (You will enter your answer here)</code></pre>
<p>Below we use the results of 3-fold and all loci (train.loci = 1) to demonstrate membership probability plots, with four different output styles.</p>
<div class="figure">
<img src="figure/Membership-genetic-only-style1.png" alt="Figure 5. Membership probability of three hypothetical populations, with results estimated via 3-fold cross-validation using overall loci (693 SNPs). Output style = 1." />
<p class="caption">Figure 5. Membership probability of three hypothetical populations, with results estimated via 3-fold cross-validation using overall loci (693 SNPs). Output style = 1.</p>
</div>
<div class="figure">
<img src="figure/Membership-genetic-only-style2.png" alt="Figure 6. Output style = 2. Individuals are sorted based on the probability of assignment to their original populations." />
<p class="caption">Figure 6. Output style = 2. Individuals are sorted based on the probability of assignment to their original populations.</p>
</div>
<div class="figure">
<img src="figure/Membership-genetic-only-style3.png" alt="Figure 7. Output style = 3. Similar to Figure 5, but with individuals assigned to different folds in separate panels." />
<p class="caption">Figure 7. Output style = 3. Similar to Figure 5, but with individuals assigned to different folds in separate panels.</p>
</div>
<div class="figure">
<img src="figure/Membership-genetic-only-style4.png" alt="Figure 8. Output style = 4. Similar to Figure 7, but with individuals sorted based on probability of assignment to their original populations." />
<p class="caption">Figure 8. Output style = 4. Similar to Figure 7, but with individuals sorted based on probability of assignment to their original populations.</p>
</div>
<p>The above Figures 5 to 8 are the results from the genetic data. Here we also created the membership probability plot of results estimated from the integrated data.</p>
<div class="figure">
<img src="figure/Membership-genetic-morph-style1.png" alt="Figure 9. Membership probability of three hypothetical populations, with results estimated based on 693 loci plus 4 morphometric measurements." />
<p class="caption">Figure 9. Membership probability of three hypothetical populations, with results estimated based on 693 loci plus 4 morphometric measurements.</p>
</div>
<p>As expected, using the integrated data allowed more individuals to be correctly assigned to the populations, particularly in populations A and B (see differences between Figure 5 or 6 vs. 9).</p>
<hr />
</div>
<div id="print-mean-and-standard-deviation-across-assignment-tests" class="section level2">
<h2>Print mean and standard deviation across assignment tests</h2>
<p>To check how test individuals from each population assigned to its own and other populations, users can use the following function to print mean and standard deviation of assignment results across Monte-Carlo or <em>K</em>-fold cross-validation tests in R console.</p>
<pre class="r"><code>#Default setting reads through all the files in the specified result folder
assign.matrix( dir=&quot;Result-folder/&quot;)

#Users also can specify certain results for printing the assignment matrix
assign.matrix( dir=&quot;Result-folder/&quot;, train.inds=c(0.7, 0.9), train.loci=c(0.5, 1))</code></pre>
<p>Once the function was executed, it will print two tables in your R console. One is the means of assignment results across the tests; the other is the corresponding standard deviations. An example of <code>assign.matrix(dir=&quot;Result-folder/&quot;)</code> is shown below.</p>
<pre><code>## Assignment across 360 tests from Monte-Carlo cross-validation
##  Mean
##          assignment
## origin   pop_A pop_B pop_C
##   pop_A   0.57  0.43  0.01
##   pop_B   0.42  0.48  0.10
##   pop_C   0.02  0.06  0.92
## 
##  Standard Deviation
##          assignment
## origin   pop_A pop_B pop_C
##   pop_A   0.24  0.24  0.02
##   pop_B   0.25  0.25  0.12
##   pop_C   0.06  0.11  0.13</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
